# Server Configuration
NODE_ENV=development
PORT=3000
HOST=0.0.0.0

# Zero Trust Configuration
ZERO_TRUST_MODE=strict
VERIFY_ALL_REQUESTS=true
DEFAULT_DENY=true

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d
JWT_ISSUER=zero-trust-gateway
JWT_AUDIENCE=zero-trust-services

# OAuth 2.0 / OIDC Configuration
OAUTH_AUTHORIZATION_URL=http://localhost:3001/oauth/authorize
OAUTH_TOKEN_URL=http://localhost:3001/oauth/token
OAUTH_USERINFO_URL=http://localhost:3001/oauth/userinfo
OAUTH_JWKS_URL=http://localhost:3001/.well-known/jwks.json
OAUTH_CLIENT_ID=gateway-client
OAUTH_CLIENT_SECRET=gateway-secret
OAUTH_REDIRECT_URI=http://localhost:3000/auth/callback
OAUTH_SCOPE=openid profile email

# PKCE Configuration
PKCE_CODE_VERIFIER_LENGTH=128
PKCE_CODE_CHALLENGE_METHOD=S256

# Rate Limiting Configuration
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false

# Redis Configuration (for rate limiting and session storage)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_TLS_ENABLED=false

# MongoDB Configuration
MONGODB_URI=mongodb://localhost:27017
MONGODB_DB_NAME=zero-trust-auth
MONGODB_USER=
MONGODB_PASSWORD=
MONGODB_MAX_POOL_SIZE=10

# CSRF Protection
CSRF_COOKIE_NAME=_csrf
CSRF_HEADER_NAME=x-csrf-token
CSRF_SECRET=your-csrf-secret-change-in-production

# Security Headers (Helmet)
CSP_REPORT_URI=/csp-report
CSP_REPORT_ONLY=false
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# mTLS Configuration
MTLS_ENABLED=true
MTLS_CA_CERT_PATH=./certs/ca.crt
MTLS_SERVER_CERT_PATH=./certs/server.crt
MTLS_SERVER_KEY_PATH=./certs/server.key
MTLS_CLIENT_CERT_REQUIRED=true
MTLS_VERIFY_DEPTH=3
MTLS_CHECK_CRL=false
MTLS_CHECK_OCSP=false

# Open Policy Agent (OPA) Configuration
OPA_ENABLED=true
OPA_URL=http://localhost:8181
OPA_POLICY_PATH=/v1/data/gateway/authz/allow
OPA_TIMEOUT_MS=5000
OPA_CACHE_TTL_MS=60000

# GraphQL Configuration
GRAPHQL_PATH=/graphql
GRAPHQL_PLAYGROUND_ENABLED=false
GRAPHQL_INTROSPECTION_ENABLED=false
GRAPHQL_DEBUG=false
GRAPHQL_MAX_DEPTH=10
GRAPHQL_MAX_COMPLEXITY=1000

# Apollo Federation Configuration
APOLLO_FEDERATION_ENABLED=true
APOLLO_GATEWAY_POLL_INTERVAL_MS=10000

# Service Registry
SERVICE_USERS_URL=http://localhost:4001/graphql
SERVICE_PRODUCTS_URL=http://localhost:4002/graphql
SERVICE_ORDERS_URL=http://localhost:4003/graphql
SERVICE_INVENTORY_URL=http://localhost:4004/graphql

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=./logs/gateway.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5
LOG_COMPRESS=true

# Monitoring Configuration
METRICS_ENABLED=true
METRICS_PATH=/metrics
METRICS_PORT=9090

# Health Check Configuration
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL_MS=30000

# Tracing Configuration
TRACING_ENABLED=true
TRACING_SERVICE_NAME=zero-trust-gateway
TRACING_EXPORTER_URL=http://localhost:14268/api/traces

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=./logs/audit.log
AUDIT_LOG_INCLUDE_REQUEST_BODY=false
AUDIT_LOG_INCLUDE_RESPONSE_BODY=false

# Session Configuration
SESSION_SECRET=your-session-secret-change-in-production
SESSION_NAME=zt_session
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# Proxy Configuration
PROXY_TIMEOUT_MS=30000
PROXY_RETRY_ATTEMPTS=3
PROXY_RETRY_DELAY_MS=1000

# Feature Flags
FEATURE_GRAPHQL_FEDERATION=true
FEATURE_MTLS=true
FEATURE_OPA_POLICIES=true
FEATURE_ADVANCED_RATE_LIMITING=true
FEATURE_REQUEST_SIGNING=true
